@using CO.CDP.RegisterOfCommercialTools.App.Models
@{
    var cpvSelection = ViewData["CpvSelection"] as CpvCodeSelection ?? new CpvCodeSelection();
}

<div class="govuk-!-margin-top-0">
    <p class="govuk-body-s govuk-!-padding-left-2">The common procurement vocabulary (CPV) is used to classify contracts
        in a standardised way</p>

    @if (cpvSelection.HasSelections)
    {
        <div class="govuk-!-margin-bottom-3 govuk-!-padding-left-2">
            <p class="govuk-body-s govuk-!-font-weight-bold">@cpvSelection.SelectionSummary:</p>
            <div class="govuk-!-margin-top-2">
                @foreach (var selectedItem in cpvSelection.SelectedItems)
                {
                    <div class="govuk-tag govuk-tag--grey govuk-!-margin-right-1 govuk-!-margin-bottom-1">
                        @selectedItem.GetDescription()
                    </div>
                }
            </div>
        </div>
    }

    <div class="accordion-highlight govuk-!-padding-2 govuk-!-margin-left-2 govuk-!-margin-right-4">
        <a href="#" class="govuk-link" id="browse-cpv-codes" data-toggle="modal" data-target="#cpv-selector-modal"
           data-api-roots="@Url.Action("GetRootCpvCodes","CpvCodes")"
           data-api-children="@Url.Action("GetChildren","CpvCodes", new { parentCode = "__PARENT__" })"
           data-api-search="@Url.Action("Search","CpvCodes")"
           data-api-bycode="@Url.Action("GetByCode","CpvCodes", new { code = "__CODE__" })">
            @cpvSelection.BrowseLinkText
        </a>
    </div>

    @foreach (var (name, value) in cpvSelection.GetHiddenInputs())
    {
        <input type="hidden" name="@name" value="@value" />
    }
</div>

<partial name="_CpvCodeSelector" model="@cpvSelection" />