= External Services

In our prject we have to integrate with external services e.g. Company House API, Postcode lookup ect

== Company House API
We are using the Companies House API to get information about the organisations in the system such as Registered Addresses and also when searching by Company Number.

== The API
The official documentation can be found here: https://developer-specs.company-information.service.gov.uk/guides/index

== How we use the API
All calls to the Companies House API are via the CompaniesHouseApi in this project. This is used for a few processes:

* The search process by Company Number:
 When adding an organisation it searches against this Company House API, and if searching by company number, when the user selects one it populates the relevent information from the API
* Look up calls: We use the API to look up latest details e.g. address

== Rate Limit
The Companies House API has a rate limit of 600 requests per 5 minutes https://developer-specs.company-information.service.gov.uk/guides/rateLimiting.
If in any case, this limit is hit, the service will recieve 429 Too Many Requests HTTP status codes from all requests beyond the limit, and throws an exception containing this status code.
[,ruby]
----
 public string CompanyName { get; set; }
 public string CompanyNumber { get; set; }
 public CompaniesHouseAddress RegisteredOfficeAddress { get; set; }
----
== How to start using Companies House API
STEP1: You need to register with your email. It will send you a verification email in your inpox.

STEP2: To register, login to https://developer.company-information.service.gov.uk/

STEP3: Once successfuly logged in, create an Application which will give you an access key, 
https://developer.company-information.service.gov.uk/manage-applications/add

STEP4: Generate a key, you can use that key in your application. Store it in either appsettings or congif file.

STEP5: Try calling the API using the API KEY. In postman use the following end-point
https://api.company-information.service.gov.uk/company/00000006/registered-office-address
User basic auth: Remember that you need to put the API key in the username and there is NO password. 

More Information and endpoints: https://developer-specs.company-information.service.gov.uk/companies-house-public-data-api/reference

